{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" href="{% static 'img/tmc-ico.ico' %}" type="image/x-icon">
  <meta charset="UTF-8">
  <title>{% block title %}{{ event.name|default:"Triatlon Madre de Ciudades" }}{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="{% static 'css/custom.css' %}">

  {% block extra_head %}{% endblock %}
</head>
<body class="d-flex flex-column min-vh-100">

<!-- ‚úÖ NAVBAR con hamburguesa integrada -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
  <div class="container d-flex align-items-center justify-content-between">
    
    <!-- Bot√≥n Hamburguesa SIEMPRE visible -->
    <button class="navbar-toggler me-2" type="button" onclick="toggleSidebar()" aria-label="Abrir men√∫">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- Logo y Marca -->
    <a class="navbar-brand d-flex align-items-center fw-bold" href="/">
      <img src="/media/img/tmc4-logo.png" alt="Logo" height="30" class="me-2">
      TMC
    </a>

    <!-- Men√∫ normal (pantallas grandes) -->
    <div class="collapse navbar-collapse d-none d-lg-block">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'gallery' %}">Galer√≠a</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'contact' %}">Contactanos</a></li>
      </ul>
    </div>
  </div>
</nav>


<!-- ‚úÖ Sidebar desplegable -->
<div id="sidebar" class="sidebar">
  <button class="close-btn" onclick="toggleSidebar()">√ó</button>
  <ul class="list-unstyled mt-4">
    <li><a href="/">Home</a></li>
    <li><a href="#">Races</a></li>
    <li><a href="#">News</a></li>
    <li><a href="#">Training</a></li>
    <li><a href="#">Community</a></li>
    <li><a href="#">Resources</a></li>
    <li><a href="#">About</a></li>
  </ul>
</div>

<!-- Overlay -->
<div id="overlay" class="overlay" onclick="toggleSidebar()"></div>

<!-- üéµ M√∫sica de fondo -->
<audio id="bg-music" autoplay loop muted>
  <source src="/media/music/puente.mp3" type="audio/mpeg">
  Tu navegador no soporta audio HTML5.
</audio>

<!-- Bot√≥n de control -->
<button id="music-toggle" onclick="toggleMusic()" class="btn btn-light position-fixed" 
        style="bottom: 13px; right: 13px; z-index:2000;">
  üîá Sonido
</button>


<!-- ‚úÖ PAGE CONTENT -->
<main class="flex-grow-1">
  {% block content %}{% endblock %}
</main>

<!-- ‚úÖ FOOTER (Sticky) -->
<footer class="bg-dark text-white text-center py-4 mt-auto">
  <div class="container">
    <p class="mb-1">¬© {{ event.name|default:"TMC 2025" }} {{ event.date.year|default:2025 }}</p>
    <p class="small">Website built with ‚ù§Ô∏è</p>
  </div>
</footer>

<!-- Bootstrap JS Bundle -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

{% block extra_js %}{% endblock %}
<script>
function toggleSidebar() {
  const sidebar = document.getElementById("sidebar");
  const overlay = document.getElementById("overlay");
  
  if (sidebar && overlay) {
    sidebar.classList.toggle("active");
    overlay.classList.toggle("active");
  } else {
    console.error("No se encontr√≥ el sidebar o el overlay");
  }
}
</script>

<script>
  const music = document.getElementById("bg-music");
  const btn = document.getElementById("music-toggle");

  // Estado inicial: muteado
  btn.classList.add("muted");

  function toggleMusic() {
    if (music.muted) {
      music.muted = false;
      music.play();
      btn.textContent = "üîä Sonando";
      btn.classList.remove("muted");
      btn.classList.add("playing");
    } else {
      music.muted = true;
      btn.textContent = "üîá M√∫sica";
      btn.classList.remove("playing");
      btn.classList.add("muted");
    }
  }
</script>

</body>
</html>
